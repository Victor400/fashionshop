{# templates/catalog/product_list.html #}
{% for p in page_obj %}
  <div class="col-6 col-md-3 mb-4">
    {% if p.slug %}
      <a href="{% url 'catalog:product_detail' p.slug %}"
         class="text-reset text-decoration-none d-block h-100">
    {% else %}
      <div class="text-reset text-decoration-none d-block h-100">
    {% endif %}

      <div class="card product-card product-card--compact h-100">
        <div class="product-card-media">
          <img
            alt="{{ p.name }}"
            src="{% static 'catalog/img/products/' %}{{ p.sku|lower }}.jpg"
            onerror="this.onerror=null;this.src='{% static 'img/placeholder.png' %}';">
        </div>
        <div class="card-body d-flex flex-column">
          <h2 class="h6 product-title text-truncate mb-1" title="{{ p.name }}">{{ p.name }}</h2>

          <div class="brand-line small text-muted mb-1">
            {% if p.brand %}{{ p.brand.name }}{% endif %}
          </div>

          {% if p.description %}
            <p class="desc-line mb-2">{{ p.description|striptags|truncatewords:10 }}</p>
          {% else %}
            <p class="desc-line mb-2">&nbsp;</p>
          {% endif %}

          <div class="mt-auto price">Â£{{ p.price|floatformat:2 }}</div>
        </div>
      </div>

    {% if p.slug %}</a>{% else %}</div>{% endif %}
  </div>
{% endfor %}
